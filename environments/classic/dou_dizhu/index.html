<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../../../genindex/" /><link rel="search" title="Search" href="../../../search/" /><link rel="next" title="Gin Rummy" href="../gin_rummy/" /><link rel="prev" title="Connect Four" href="../connect_four/" />
        <link rel="canonical" href="https://www.pettingzoo.ml/environments/classic/dou_dizhu.html" />

    <link rel="shortcut icon" href="../../../_static/favicon.png"/><meta name="generator" content="sphinx-5.1.1, furo 2022.06.21"/>
        <title>Dou Dizhu - PettingZoo Documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=40978830699223671f4072448e654b5958f38b89" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style>

</head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../"><div class="brand">PettingZoo Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../_static/img/PettingZoo.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../_static/img/PettingZoo_White.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">PettingZoo Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search/" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Basic</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../content/api/">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../content/environment_creation/">Environment Creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../content/wrappers/">Wrappers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../content/tutorials/">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Environments</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../atari/">Atari</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../atari/basketball_pong/">Basketball Pong</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../atari/boxing/">Boxing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../atari/combat_plane/">Combat: Plane</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../atari/combat_tank/">Combat: Tank</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../atari/double_dunk/">Double Dunk</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../atari/entombed_competitive/">Emtombed: Competitive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../atari/entombed_cooperative/">Emtombed: Cooperative</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../atari/flag_capture/">Flag Capture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../atari/foozpong/">Foozpong</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../atari/ice_hockey/">Ice Hockey</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../atari/joust/">Joust</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../atari/mario_bros/">Mario Bros</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../atari/maze_craze/">Maze Craze</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../atari/othello/">Othello</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../atari/pong/">Pong</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../atari/quadrapong/">Quadrapong</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../atari/space_invaders/">Space Invaders</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../atari/space_war/">Space War</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../atari/surround/">Surround</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../atari/tennis/">Tennis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../atari/video_checkers/">Video Checkers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../atari/volleyball_pong/">Volleyball Pong</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../atari/warlords/">Warlords</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../atari/wizard_of_wor/">Wizard of Wor</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../butterfly/">Butterfly</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../butterfly/cooperative_pong/">Cooperative Pong</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../butterfly/knights_archers_zombies/">Knights Archers Zombies (‘KAZ’)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../butterfly/pistonball/">Pistonball</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../">Classic</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../backgammon/">Backgammon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../checkers/">Checkers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chess/">Chess</a></li>
<li class="toctree-l2"><a class="reference internal" href="../connect_four/">Connect Four</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Dou Dizhu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gin_rummy/">Gin Rummy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../go/">Go</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hanabi/">Hanabi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../leduc_holdem/">Leduc Hold’em</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mahjong/">Mahjong</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rps/">Rock Paper Scissors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../texas_holdem_no_limit/">Texas Hold’em No Limit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../texas_holdem/">Texas Hold’em</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tictactoe/">Tic Tac Toe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../uno/">Uno</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../magent/">MAgent</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../magent/adversarial_pursuit/">Adversarial Pursuit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../magent/battle/">Battle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../magent/battlefield/">Battlefield</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../magent/combined_arms/">Combined Arms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../magent/gather/">Gather</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../magent/tiger_deer/">Tiger-Deer</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../mpe/">MPE</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../mpe/simple/">Simple</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mpe/simple_adversary/">Simple Adversary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mpe/simple_crypto/">Simple Crypto</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mpe/simple_push/">Simple Push</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mpe/simple_speaker_listener/">Simple Speaker Listener</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mpe/simple_spread/">Simple Spread</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mpe/simple_tag/">Simple Tag</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mpe/simple_world_comm/">Simple World Comm</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../sisl/">SISL</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../sisl/multiwalker/">Multiwalker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sisl/pursuit/">Pursuit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sisl/waterworld/">Waterworld</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../third_party_envs/">Third-Party Environments</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Farama-Foundation/PettingZoo">Github</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container"><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div class="theme-env-icon-container">
              <img class="theme-env-icon" src="/_static/img/icons/Classic/DouDizhu.png">
            </div>
          <section id="dou-dizhu">
<h1>Dou Dizhu<a class="headerlink" href="#dou-dizhu" title="Permalink to this heading">#</a></h1>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="../../../_images/classic_dou_dizhu.gif"><img alt="../../../_images/classic_dou_dizhu.gif" src="../../../_images/classic_dou_dizhu.gif" style="width: 140px;" /></a>
</figure>
<p>This environment is part of the <a href='..'>classic environments</a>. Please read that page first for general information.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Import</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">pettingzoo.classic</span> <span class="pre">import</span> <span class="pre">dou_dizhu_v4</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Actions</p></td>
<td><p>Discrete</p></td>
</tr>
<tr class="row-odd"><td><p>Parallel API</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>Manual Control</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>Agents</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">agents=</span> <span class="pre">['landlord_0',</span> <span class="pre">'peasant_0',</span> <span class="pre">'peasant_1']</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Agents</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-odd"><td><p>Action Shape</p></td>
<td><p>Discrete(27472)</p></td>
</tr>
<tr class="row-even"><td><p>Action Values</p></td>
<td><p>Discrete(27472)</p></td>
</tr>
<tr class="row-odd"><td><p>Observation Shape</p></td>
<td><p>(901,),(790,)</p></td>
</tr>
<tr class="row-even"><td><p>Observation Values</p></td>
<td><p>[0,1]</p></td>
</tr>
</tbody>
</table>
</div>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="../../../_images/classic_dou_dizhu_aec.svg"><img alt="../../../_images/classic_dou_dizhu_aec.svg" src="../../../_images/classic_dou_dizhu_aec.svg" width="200px" /></a>
</figure>
<p>Dou Dizhu, or <em>Fighting the Landlord</em>, is a shedding game involving 3 players and a deck of cards plus 2 jokers with suits being irrelevant. Heuristically, one player is designated the “Landlord” and the others become the “Peasants”. The objective of the game is to be the first one to have no cards left. If the first person to have no cards left is part of the “Peasant” team, then all members of the “Peasant” team receive a reward (+1). If the “Landlord” wins, then only the “Landlord” receives a reward (+1).</p>
<p>The “Landlord” plays first by putting down a combination of cards. The next player, may pass or put down a higher combination of cards that beat the previous play.</p>
<p>Our implementation wraps <a class="reference external" href="http://rlcard.org/games.html#dou-dizhu">RLCard</a> and you can refer to its documentation for additional details. Please cite their work if you use this game in research.</p>
<section id="arguments">
<h2>Arguments<a class="headerlink" href="#arguments" title="Permalink to this heading">#</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dou_dizhu_v4</span><span class="o">.</span><span class="n">env</span><span class="p">(</span><span class="n">opponents_hand_visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">opponents_hand_visible</span></code>:  Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to observe the entire observation space as described in <code class="docutils literal notranslate"><span class="pre">Observation</span> <span class="pre">Space</span></code> below. Setting it to <code class="docutils literal notranslate"><span class="pre">False</span></code> will remove any observation of the opponent’ hands.</p>
</section>
<section id="observation-space">
<h2>Observation Space<a class="headerlink" href="#observation-space" title="Permalink to this heading">#</a></h2>
<p>The observation is a dictionary which contains an <code class="docutils literal notranslate"><span class="pre">'observation'</span></code> element which is the usual RL observation described below, and an  <code class="docutils literal notranslate"><span class="pre">'action_mask'</span></code> which holds the legal moves, described in the Legal Actions Mask section.</p>
<p>The main <em>Observation Space</em> is encoded in a 1D vector with different concatenated features depending on the agent. To represent a combination of cards a 54-dimensional one-hot vector is encoded as follows. A 4x15 is constructed, where each column represents the rank of the cards (including the two jokers), and each row the number of matching card rank. The matrix is constructed using one-hot encoding. Since there are two jokers in the deck, the six entries that are always zero in the columns of the jokers are removed. Finally, to form the 54-dimensional vector, the one-hot matrix is flatten.
The columns and rows of the 4x15 matrix are encoded as follows:</p>
<section id="encoding-per-plane">
<h3>Encoding per Plane<a class="headerlink" href="#encoding-per-plane" title="Permalink to this heading">#</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Plane Row Index</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>0</p></td>
<td><p>0 matching cards of same rank</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>1</p></td>
<td><p>1 matching cards of same rank</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>2</p></td>
<td><p>2 matching cards of same rank</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>3</p></td>
<td><p>3 matching cards of same rank</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>4</p></td>
<td><p>4 matching cards of same rank</p></td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Plane Column Index</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>0</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>1</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>7</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>8</p></td>
<td><p>Jack</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>9</p></td>
<td><p>Queen</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>10</p></td>
<td><p>King</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>11</p></td>
<td><p>Ace</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>12</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>13</p></td>
<td><p>Black Joker</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>14</p></td>
<td><p>Red Joker</p></td>
</tr>
</tbody>
</table>
</div>
<p>The obsesrvation space of the landlord and the two peasants have different dimensions. The different agent observation spaces encode the following features:</p>
</section>
<section id="landlord-observation">
<h3>Landlord Observation<a class="headerlink" href="#landlord-observation" title="Permalink to this heading">#</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head text-center"><p>Feature Index</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">current_hand</span></code></p></td>
<td class="text-center"><p>[0:53]</p></td>
<td><p>Current landlord’s hand as a 54-dimensional one-hot vector</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">others_hand</span></code></p></td>
<td class="text-center"><p>[54:107]</p></td>
<td><p>Other players hand (if <code class="docutils literal notranslate"><span class="pre">opponents_hand_visible</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">last_action</span></code></p></td>
<td class="text-center"><p>[108:161]</p></td>
<td><p>The most recent action as a 54-dimensional one-hot vector</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">last_9_actions</span></code></p></td>
<td class="text-center"><p>[162:647]</p></td>
<td><p>The most recent 9 actions</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">landlord_up_played_cards</span></code></p></td>
<td class="text-center"><p>[648:701]</p></td>
<td><p>The union of all the cards played by the player that acts before the landlord as a 54-dimensional one-hot vector</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">landlord_down_played_cards</span></code></p></td>
<td class="text-center"><p>[702:755]</p></td>
<td><p>The union of all the cards played by the player that acts after the landlord as a 54-dimensional one-hot vector</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">landlord_up_num_cards_left</span></code></p></td>
<td class="text-center"><p>[756:772]</p></td>
<td><p>Number of cards left for the peasant player that plays before the landlord</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">landlord_down_num_cards_left</span></code></p></td>
<td class="text-center"><p>[773:789]</p></td>
<td><p>Number of cards left for the peasant player that plays after the landlord</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="peasant-observation">
<h3>Peasant Observation<a class="headerlink" href="#peasant-observation" title="Permalink to this heading">#</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head text-center"><p>Feature Index</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">current_hand</span></code></p></td>
<td class="text-center"><p>[0:53]</p></td>
<td><p>Current landlord’s hand as a 54-dimensional one-hot vector</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">others_hand</span></code></p></td>
<td class="text-center"><p>[54:107]</p></td>
<td><p>Other players hand (if <code class="docutils literal notranslate"><span class="pre">opponents_hand_visible</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">last_action</span></code></p></td>
<td class="text-center"><p>[108:161]</p></td>
<td><p>The most recent action as a 54-dimensional one-hot vector</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">last_9_actions</span></code></p></td>
<td class="text-center"><p>[162:647]</p></td>
<td><p>The most recent 9 actions</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">landlord_played_cards</span></code></p></td>
<td class="text-center"><p>[648:701]</p></td>
<td><p>The union of all the cards played by the landlord</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">teammate_played_cards</span></code></p></td>
<td class="text-center"><p>[702:755]</p></td>
<td><p>The union of all the cards played by the other peasant agent</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">last_landlord_action</span></code></p></td>
<td class="text-center"><p>[756:809]</p></td>
<td><p>The last action played by the landlord</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">last_teammate_action</span></code></p></td>
<td class="text-center"><p>[810:863]</p></td>
<td><p>The last action played by the other peasant agent</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">landlord_num_cards_left</span></code></p></td>
<td class="text-center"><p>[864:883]</p></td>
<td><p>Number of cards left for the landlord</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">teammate_num_cards_left</span></code></p></td>
<td class="text-center"><p>[884:900]</p></td>
<td><p>Number of cards left for the other peasant agent</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="legal-actions-mask">
<h3>Legal Actions Mask<a class="headerlink" href="#legal-actions-mask" title="Permalink to this heading">#</a></h3>
<p>The legal moves available to the current agent are found in the <code class="docutils literal notranslate"><span class="pre">action_mask</span></code> element of the dictionary observation. The <code class="docutils literal notranslate"><span class="pre">action_mask</span></code> is a binary vector where each index of the vector represents whether the action is legal or not. The <code class="docutils literal notranslate"><span class="pre">action_mask</span></code> will be all zeros for any agent except the one whose turn it is. Taking an illegal move ends the game with a reward of -1 for the illegally moving agent and a reward of 0 for all other agents.</p>
</section>
</section>
<section id="action-space">
<h2>Action Space<a class="headerlink" href="#action-space" title="Permalink to this heading">#</a></h2>
<p>The raw size of the action space of Dou Dizhu is 27,472. As a reminder, suits are irrelevant in Dou Dizhu.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Action Type</p></th>
<th class="head"><p>Description</p></th>
<th class="head text-center"><p>Action ID</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Solo</p></td>
<td><p>Any single card</p></td>
<td class="text-center"><p>0-14</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0</span></code>: 3, <code class="docutils literal notranslate"><span class="pre">1</span></code>: 4, …, <code class="docutils literal notranslate"><span class="pre">12</span></code>: 2, <code class="docutils literal notranslate"><span class="pre">13</span></code>: Black Joker, <code class="docutils literal notranslate"><span class="pre">14</span></code>: Red Joker</p></td>
</tr>
<tr class="row-odd"><td><p>Pair</p></td>
<td><p>Two matching cards of equal rank</p></td>
<td class="text-center"><p>15-27</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">15</span></code>: 33, <code class="docutils literal notranslate"><span class="pre">16</span></code>: 44, …, <code class="docutils literal notranslate"><span class="pre">25</span></code>: KK, <code class="docutils literal notranslate"><span class="pre">26</span></code>: AA, <code class="docutils literal notranslate"><span class="pre">27</span></code>: 22</p></td>
</tr>
<tr class="row-even"><td><p>Trio</p></td>
<td><p>Three matching cards of equal rank</p></td>
<td class="text-center"><p>28-40</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">28</span></code>: 333, <code class="docutils literal notranslate"><span class="pre">29</span></code>: 444, …, <code class="docutils literal notranslate"><span class="pre">38</span></code>: KKK, <code class="docutils literal notranslate"><span class="pre">39</span></code>: AAA, <code class="docutils literal notranslate"><span class="pre">40</span></code>: 222</p></td>
</tr>
<tr class="row-odd"><td><p>Trio with single</p></td>
<td><p>Three matching cards of equal rank + single card as the kicker (e.g. 3334)</p></td>
<td class="text-center"><p>41-222</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">41</span></code>: 3334, <code class="docutils literal notranslate"><span class="pre">42</span></code>: 3335, …, <code class="docutils literal notranslate"><span class="pre">220</span></code>: A222, <code class="docutils literal notranslate"><span class="pre">221</span></code>: 222B, <code class="docutils literal notranslate"><span class="pre">222</span></code>: 222R</p></td>
</tr>
<tr class="row-even"><td><p>Trio with pair</p></td>
<td><p>Three matching cards of equal rank + pair of cards as the kicker (e.g. 33344)</p></td>
<td class="text-center"><p>223-378</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">223</span></code>: 33344, <code class="docutils literal notranslate"><span class="pre">224</span></code>: 33355, …, <code class="docutils literal notranslate"><span class="pre">376</span></code>: QQ222, <code class="docutils literal notranslate"><span class="pre">377</span></code>: KK222, <code class="docutils literal notranslate"><span class="pre">378</span></code>: AA222</p></td>
</tr>
<tr class="row-odd"><td><p>Chain of solo</p></td>
<td><p>At least five consecutive solo cards</p></td>
<td class="text-center"><p>379-414</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">379</span></code>: 34567, <code class="docutils literal notranslate"><span class="pre">380</span></code>: 45678, …, <code class="docutils literal notranslate"><span class="pre">412</span></code>: 3456789TJQK, <code class="docutils literal notranslate"><span class="pre">413</span></code>: 456789TJQKA, <code class="docutils literal notranslate"><span class="pre">414</span></code>: 3456789TJQKA</p></td>
</tr>
<tr class="row-even"><td><p>Chain of pair</p></td>
<td><p>At least three consecutive pairs</p></td>
<td class="text-center"><p>415-466</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">415</span></code>: 334455, <code class="docutils literal notranslate"><span class="pre">416</span></code>: 445566, …, <code class="docutils literal notranslate"><span class="pre">464</span></code>: 33445566778899TTJJQQ, <code class="docutils literal notranslate"><span class="pre">465</span></code>: 445566778899TTJJQQKK, <code class="docutils literal notranslate"><span class="pre">466</span></code>: 5566778899TTJJQQKKAA</p></td>
</tr>
<tr class="row-odd"><td><p>Chain of trio</p></td>
<td><p>At least two consecutive trios</p></td>
<td class="text-center"><p>467-511</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">467</span></code>: 333444, <code class="docutils literal notranslate"><span class="pre">467</span></code>: 444555, …, <code class="docutils literal notranslate"><span class="pre">509</span></code>: 777888999TTTJJJQQQ, <code class="docutils literal notranslate"><span class="pre">510</span></code>: 888999TTTJJJQQQKKK, <code class="docutils literal notranslate"><span class="pre">511</span></code>: 999TTTJJJQQQKKKAAA</p></td>
</tr>
<tr class="row-even"><td><p>Plane with solo</p></td>
<td><p>Two consecutive trios + a distinct kicker for each trio (e.g. 33344456)</p></td>
<td class="text-center"><p>512-22333</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">512</span></code>: 33344455, <code class="docutils literal notranslate"><span class="pre">513</span></code>: 33344456, …, <code class="docutils literal notranslate"><span class="pre">22331</span></code>: 899TTTJJJQQQKKKAAA22, <code class="docutils literal notranslate"><span class="pre">22332</span></code>: 89TTTJJJQQQKKKAAA222, <code class="docutils literal notranslate"><span class="pre">22333</span></code>: 99TTTJJJQQQKKKAAA222</p></td>
</tr>
<tr class="row-odd"><td><p>Plane with pair</p></td>
<td><p>Two consecutive trios + 2 distinct pairs (e.g. 3334445566)</p></td>
<td class="text-center"><p>22334-25272</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">22334</span></code>: 3334445566, <code class="docutils literal notranslate"><span class="pre">22335</span></code>: 3334445577, …, <code class="docutils literal notranslate"><span class="pre">25270</span></code>: 7788TTJJJQQQKKKAAA22, <code class="docutils literal notranslate"><span class="pre">25271</span></code>: 7799TTJJJQQQKKKAAA22, <code class="docutils literal notranslate"><span class="pre">25272</span></code>: 8899TTJJJQQQKKKAAA22</p></td>
</tr>
<tr class="row-even"><td><p>Quad with solo</p></td>
<td><p>Four matching cards of equal rank + 2 distinct solo cards (e.g 333345)</p></td>
<td class="text-center"><p>25273-26598</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">25273</span></code>: 333344, <code class="docutils literal notranslate"><span class="pre">25274</span></code>: 333345, …, <code class="docutils literal notranslate"><span class="pre">26596</span></code>: AA2222, <code class="docutils literal notranslate"><span class="pre">26597</span></code>: A2222B, <code class="docutils literal notranslate"><span class="pre">26598</span></code>: A2222R</p></td>
</tr>
<tr class="row-odd"><td><p>Quad with pair</p></td>
<td><p>Four matching cards of equal rank + 2 distinct pairs (e.g 33334455)</p></td>
<td class="text-center"><p>26599-27456</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">26599</span></code>: 33334455, <code class="docutils literal notranslate"><span class="pre">26600</span></code>: 33334466, …, <code class="docutils literal notranslate"><span class="pre">27454</span></code>: QQKK2222, <code class="docutils literal notranslate"><span class="pre">27455</span></code>: QQAA2222, <code class="docutils literal notranslate"><span class="pre">27456</span></code>: KKAA2222</p></td>
</tr>
<tr class="row-even"><td><p>Bomb</p></td>
<td><p>Four matching cards of equal rank</p></td>
<td class="text-center"><p>27457-275469</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">27457</span></code>: 3333, <code class="docutils literal notranslate"><span class="pre">27458</span></code>: 4444, …, <code class="docutils literal notranslate"><span class="pre">275467</span></code>: KKKK, <code class="docutils literal notranslate"><span class="pre">275468</span></code>: AAAA, <code class="docutils literal notranslate"><span class="pre">275469</span></code>: 2222</p></td>
</tr>
<tr class="row-odd"><td><p>Rocket</p></td>
<td><p>Black Joker + Red Joker</p></td>
<td class="text-center"><p>275470</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">275470</span></code>: Black Joker (B) + Red Joker (R)</p></td>
</tr>
<tr class="row-even"><td><p>Pass</p></td>
<td><p>Pass</p></td>
<td class="text-center"><p>275471</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">275471</span></code>: Pass</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="rewards">
<h2>Rewards<a class="headerlink" href="#rewards" title="Permalink to this heading">#</a></h2>
<p>We modified the reward structure compared to RLCard. Instead of rewarding <code class="docutils literal notranslate"><span class="pre">0</span></code> to the losing player, we assigned a <code class="docutils literal notranslate"><span class="pre">-1</span></code> reward to the losing agent.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Winner</p></th>
<th class="head text-center"><p>Loser</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>+1</p></td>
<td class="text-center"><p>-1</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="version-history">
<h2>Version History<a class="headerlink" href="#version-history" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>v4: Upgrade to RLCard 1.0.3 (major changes to observation and action space) (1.11.0)</p></li>
<li><p>v3: Fixed bug in arbitrary calls to observe() (1.8.0)</p></li>
<li><p>v2: Bumped RLCard version, bug fixes, legal action mask in observation replaced illegal move list in infos (1.5.0)</p></li>
<li><p>v1: Bumped RLCard version, fixed observation space, adopted new agent iteration scheme where all agents are iterated over after they are done (1.4.0)</p></li>
<li><p>v0: Initial versions release (1.0.0)</p></li>
</ul>
</div></section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../gin_rummy/">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Gin Rummy</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../connect_four/">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Connect Four</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Dou Dizhu</a><ul>
<li><a class="reference internal" href="#arguments">Arguments</a></li>
<li><a class="reference internal" href="#observation-space">Observation Space</a><ul>
<li><a class="reference internal" href="#encoding-per-plane">Encoding per Plane</a></li>
<li><a class="reference internal" href="#landlord-observation">Landlord Observation</a></li>
<li><a class="reference internal" href="#peasant-observation">Peasant Observation</a></li>
<li><a class="reference internal" href="#legal-actions-mask">Legal Actions Mask</a></li>
</ul>
</li>
<li><a class="reference internal" href="#action-space">Action Space</a></li>
<li><a class="reference internal" href="#rewards">Rewards</a></li>
<li><a class="reference internal" href="#version-history">Version History</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    </body>
</html>